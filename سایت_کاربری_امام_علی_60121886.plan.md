---
name: سایت کاربری امام علی
overview: پیاده‌سازی کامل سایت کاربری (hospital-client) با نام "امام علی" شامل صفحه اصلی زیبا، ثبت‌نام بیمار، رزرو ویزیت، خدمات پاراکلینیک (آزمایشگاه با کد رهگیری، سونوگرافی، رادیولوژی، MRI)، انتخاب مرکز بر اساس بیمه و ثبت درخواست
todos:
  - id: setup-dependencies
    content: نصب و تنظیم dependencies در hospital-client (react-router-dom, axios, react-query, tailwindcss, react-hook-form, zod)
    status: completed
  - id: setup-routing
    content: تنظیم routing در App.tsx با تمام مسیرهای مورد نیاز
    status: completed
  - id: setup-api-client
    content: ایجاد api/client.ts و تنظیم axios با base URL بک‌اند
    status: completed
  - id: create-auth-context
    content: ایجاد AuthContext برای مدیریت احراز هویت کاربر
    status: completed
  - id: create-layout-components
    content: ایجاد کامپوننت‌های Header, Footer, Navigation با طراحی زیبا و لوگو امام علی
    status: completed
  - id: create-home-page
    content: پیاده‌سازی صفحه اصلی (Home.tsx) با Hero section و دسترسی سریع به خدمات
    status: completed
  - id: create-services-list
    content: پیاده‌سازی صفحه لیست خدمات (ServicesList.tsx) با دسته‌بندی و فیلتر
    status: pending
  - id: create-service-detail
    content: پیاده‌سازی صفحه جزئیات خدمت (ServiceDetail.tsx)
    status: pending
  - id: create-book-service
    content: پیاده‌سازی فرم ثبت درخواست (BookService.tsx) با 6 مرحله
    status: pending
  - id: create-select-clinic
    content: پیاده‌سازی صفحه انتخاب مرکز (SelectClinic.tsx) با فیلتر بر اساس بیمه
    status: pending
  - id: create-patient-form
    content: ایجاد کامپوننت PatientForm برای ثبت اطلاعات بیمار
    status: pending
  - id: create-insurance-selector
    content: ایجاد کامپوننت InsuranceSelector برای انتخاب بیمه
    status: pending
  - id: create-book-lab
    content: پیاده‌سازی صفحه ثبت درخواست آزمایش (BookLab.tsx) با حالت‌های با/بدون کد رهگیری
    status: pending
  - id: create-track-result
    content: پیاده‌سازی صفحه رهگیری نتیجه (TrackResult.tsx)
    status: pending
  - id: add-tracking-code-backend
    content: اضافه کردن فیلد TrackingCode به ServiceRequest entity و ایجاد migration
    status: pending
  - id: add-track-endpoint
    content: اضافه کردن endpoint GET /api/service-requests/track/{trackingCode} در بک‌اند
    status: pending
  - id: add-clinic-filter-endpoint
    content: اضافه کردن فیلتر مراکز بر اساس بیمه در ClinicsController
    status: pending
  - id: create-register-login
    content: پیاده‌سازی صفحات Register و Login
    status: in_progress
  - id: create-patient-profile
    content: پیاده‌سازی صفحه پروفایل بیمار (Profile.tsx)
    status: pending
  - id: create-requests-list
    content: پیاده‌سازی لیست درخواست‌های بیمار (Requests.tsx)
    status: pending
  - id: create-api-services
    content: ایجاد تمام API service files در hospital-client/src/api/services/
    status: completed
  - id: polish-ui-ux
    content: بهبود UI/UX، اضافه کردن animations، loading states، error handling
    status: pending
---

# نقشه راه پیاده‌سازی سایت کاربری امام علی



## وضعیت فعلی

### موجود در پروژه:

- ✅ **Backend**: API کامل با Entity Framework، Controllers، Services
- ✅ **Frontend (Admin Panel)**: پنل مدیریت در `frontend/` با React + TypeScript
- ✅ **hospital-client**: پروژه خالی با React + Vite (فقط template اولیه)
- ✅ **Entities**: Service, ServiceRequest, PatientProfile, Insurance, Clinic, ServiceCategory
- ✅ **API Endpoints**: موجود برای Services, Clinics, Insurances, ServiceRequests

### نیاز به پیاده‌سازی:

- ❌ **hospital-client**: نیاز به پیاده‌سازی کامل از صفر
- ❌ **Tracking Code**: فیلد کد رهگیری برای خدمات آزمایشگاهی (نیاز به اضافه کردن به ServiceRequest)
- ❌ **UI/UX**: طراحی کاربرپسند و زیبا

## معماری و ساختار

### 1. ساختار پروژه hospital-client

```javascript
hospital-client/
├── src/
│   ├── pages/
│   │   ├── Home.tsx                    # صفحه اصلی زیبا
│   │   ├── Services/
│   │   │   ├── ServicesList.tsx        # لیست خدمات (ویزیت، آزمایش، سونو، رادیولوژی، MRI)
│   │   │   ├── ServiceDetail.tsx        # جزئیات هر خدمت
│   │   │   └── BookService.tsx          # فرم ثبت درخواست خدمت
│   │   ├── Patient/
│   │   │   ├── Register.tsx            # ثبت‌نام/ورود بیمار
│   │   │   ├── Profile.tsx              # پروفایل بیمار
│   │   │   └── Requests.tsx             # لیست درخواست‌های بیمار
│   │   ├── Laboratory/
│   │   │   ├── BookLab.tsx             # ثبت درخواست آزمایش
│   │   │   └── TrackResult.tsx          # رهگیری نتیجه با کد رهگیری
│   │   └── Clinics/
│   │       └── SelectClinic.tsx        # انتخاب مرکز بر اساس بیمه
│   ├── components/
│   │   ├── layout/
│   │   │   ├── Header.tsx              # هدر با لوگو امام علی
│   │   │   ├── Footer.tsx              # فوتر
│   │   │   └── Navigation.tsx           # منوی ناوبری
│   │   ├── service/
│   │   │   ├── ServiceCard.tsx         # کارت نمایش خدمت
│   │   │   ├── ServiceCategory.tsx     # دسته‌بندی خدمات
│   │   │   └── InsuranceSelector.tsx    # انتخاب بیمه
│   │   ├── patient/
│   │   │   ├── PatientForm.tsx         # فرم ثبت اطلاعات بیمار
│   │   │   └── RequestCard.tsx         # کارت نمایش درخواست
│   │   └── common/
│   │       ├── Button.tsx
│   │       ├── Input.tsx
│   │       ├── Select.tsx
│   │       └── Loading.tsx
│   ├── api/
│   │   ├── client.ts                   # تنظیم axios
│   │   └── services/
│   │       ├── serviceService.ts
│   │       ├── clinicService.ts
│   │       ├── insuranceService.ts
│   │       ├── serviceRequestService.ts
│   │       └── patientService.ts
│   ├── contexts/
│   │   └── AuthContext.tsx              # مدیریت احراز هویت
│   ├── hooks/
│   │   └── useAuth.ts
│   └── utils/
│       └── helpers.ts
```



## صفحات و قابلیت‌ها

### 2. صفحه اصلی (Home.tsx)

**ویژگی‌ها:**

- Hero section با تصویر و متن خوش‌آمدگویی
- معرفی بیمارستان امام علی
- دسترسی سریع به خدمات اصلی:
- ویزیت پزشک
- آزمایشگاه
- سونوگرافی
- رادیولوژی
- MRI
- نمایش آمار و اطلاعات (اختیاری)
- بخش تماس و آدرس

**طراحی:**

- استفاده از Tailwind CSS یا CSS Modules
- Responsive design
- انیمیشن‌های ملایم
- رنگ‌بندی حرفه‌ای و کاربرپسند

### 3. خدمات پاراکلینیک

#### 3.1 صفحه لیست خدمات (ServicesList.tsx)

**دسته‌بندی‌ها:**

- **ویزیت**: ویزیت حضوری، ویزیت آنلاین
- **آزمایشگاه**: 
- با کد رهگیری (نیاز به پزشک)
- بدون کد رهگیری (مستقیم)
- **سونوگرافی**
- **رادیولوژی**
- **MRI**

**ویژگی‌ها:**

- فیلتر بر اساس دسته‌بندی
- جستجو
- نمایش قیمت و مدت زمان
- دکمه "رزرو" برای هر خدمت

#### 3.2 صفحه جزئیات خدمت (ServiceDetail.tsx)

**اطلاعات نمایش داده شده:**

- نام و توضیحات خدمت
- قیمت پایه
- مدت زمان تقریبی
- نیاز به پزشک (برای آزمایش با کد رهگیری)
- تصویر خدمت (در صورت وجود)

**دکمه‌ها:**

- "رزرو این خدمت"
- "بازگشت به لیست"

#### 3.3 فرم ثبت درخواست (BookService.tsx)

**مراحل ثبت درخواست:مرحله 1: انتخاب نوع خدمت**

- انتخاب از لیست خدمات
- نمایش قیمت

**مرحله 2: ثبت اطلاعات بیمار**

- نام و نام خانوادگی
- کد ملی
- شماره تماس
- تاریخ تولد
- جنسیت
- آدرس
- اطلاعات بیمه (در صورت نیاز)

**مرحله 3: انتخاب بیمه (در صورت نیاز)**

- لیست بیمه‌های پوشش‌دهنده
- انتخاب بیمه
- وارد کردن شماره بیمه
- محاسبه سهم بیمه و پرداختی بیمار

**مرحله 4: انتخاب مرکز (SelectClinic.tsx)**

- فیلتر مراکز بر اساس:
- بیمه انتخاب شده
- نوع خدمت
- شهر/منطقه
- نمایش لیست مراکز با:
- نام مرکز
- آدرس
- قیمت خدمت در آن مرکز
- ساعات کاری
- انتخاب مرکز

**مرحله 5: انتخاب زمان (برای ویزیت)**

- تقویم انتخاب تاریخ
- انتخاب ساعت (بر اساس ساعات کاری مرکز)
- یا انتخاب "بدون زمان مشخص" (برای خدمات آزمایشگاهی)

**مرحله 6: تایید و ثبت**

- نمایش خلاصه درخواست:
- خدمت
- مرکز
- قیمت کل
- سهم بیمه
- پرداختی بیمار
- زمان (در صورت وجود)
- دکمه "ثبت درخواست"
- پس از ثبت:
- نمایش پیام موفقیت
- نمایش کد رهگیری (برای آزمایشگاه)
- لینک به صفحه رهگیری

### 4. خدمات آزمایشگاه

#### 4.1 ثبت درخواست آزمایش (BookLab.tsx)

**دو حالت:الف) با کد رهگیری:**

- نیاز به انتخاب پزشک
- وارد کردن کد رهگیری از پزشک
- انتخاب آزمایش‌های مورد نیاز
- ادامه مراحل عادی

**ب) بدون کد رهگیری:**

- انتخاب مستقیم آزمایش‌ها
- ادامه مراحل عادی

**ویژگی‌های خاص:**

- امکان انتخاب چند آزمایش همزمان
- نمایش لیست آزمایش‌های محبوب
- جستجو در لیست آزمایش‌ها

#### 4.2 رهگیری نتیجه (TrackResult.tsx)

**ویژگی‌ها:**

- ورود کد رهگیری
- نمایش وضعیت درخواست:
- ثبت شده
- در حال انجام
- آماده
- نمایش نتایج (در صورت آماده بودن)
- دانلود فایل نتایج (در صورت وجود)

### 5. مدیریت پروفایل بیمار

#### 5.1 ثبت‌نام/ورود (Register.tsx)

**فرم ثبت‌نام:**

- شماره موبایل
- کد ملی
- نام و نام خانوادگی
- رمز عبور
- تایید رمز عبور
- کد OTP (ارسال به موبایل)

**فرم ورود:**

- شماره موبایل
- رمز عبور
- یا ورود با OTP

#### 5.2 پروفایل بیمار (Profile.tsx)

**اطلاعات قابل ویرایش:**

- اطلاعات شخصی
- اطلاعات پزشکی (گروه خونی، قد، وزن)
- اطلاعات تماس اضطراری
- بیمه‌ها

#### 5.3 لیست درخواست‌ها (Requests.tsx)

**ویژگی‌ها:**

- نمایش تمام درخواست‌های بیمار
- فیلتر بر اساس وضعیت
- جستجو
- مشاهده جزئیات هر درخواست
- رهگیری درخواست
- دانلود نتایج

## Backend - تغییرات مورد نیاز

### 6. اضافه کردن Tracking Code

**فایل:** `backend/HospitalSystem.Domain/Entities/ServiceRequest.cs`**تغییرات:**

```csharp
public string? TrackingCode { get; set; }  // کد رهگیری برای آزمایشگاه
```

**Migration:**

- ایجاد migration برای اضافه کردن ستون `tracking_code` به جدول `ServiceRequest`
- تولید خودکار کد رهگیری هنگام ثبت درخواست آزمایشگاهی

**API Endpoint جدید:**

- `GET /api/service-requests/track/{trackingCode}` - رهگیری با کد رهگیری

### 7. API Endpoints مورد نیاز

**موجود:**

- ✅ `GET /api/services` - لیست خدمات
- ✅ `GET /api/services/{id}` - جزئیات خدمت
- ✅ `GET /api/clinics` - لیست مراکز
- ✅ `GET /api/clinics/{id}` - جزئیات مرکز
- ✅ `GET /api/insurances` - لیست بیمه‌ها
- ✅ `POST /api/service-requests` - ثبت درخواست

**نیاز به اضافه/تکمیل:**

- `GET /api/clinics?insuranceId={id}&serviceId={id}` - فیلتر مراکز بر اساس بیمه و خدمت
- `GET /api/service-requests/track/{trackingCode}` - رهگیری با کد
- `GET /api/service-requests/patient/{patientId}` - درخواست‌های یک بیمار
- `POST /api/auth/register` - ثبت‌نام بیمار (بررسی شود)
- `POST /api/auth/login` - ورود (موجود است)

## Frontend - پیاده‌سازی

### 8. تنظیمات اولیه

**فایل‌ها:**

- `hospital-client/package.json` - اضافه کردن dependencies:
- `react-router-dom` - برای routing
- `axios` - برای API calls
- `@tanstack/react-query` - برای state management
- `tailwindcss` - برای styling (یا CSS Modules)
- `date-fns` - برای کار با تاریخ
- `react-hook-form` - برای فرم‌ها
- `zod` - برای validation
- `hospital-client/src/api/client.ts` - تنظیم axios با base URL بک‌اند

### 9. Routing

**فایل:** `hospital-client/src/App.tsx`**Routes:**

```javascript
/ → Home
/services → ServicesList
/services/:id → ServiceDetail
/book/:serviceId → BookService
/laboratory → BookLab
/laboratory/track → TrackResult
/patient/register → Register
/patient/login → Login
/patient/profile → Profile (Protected)
/patient/requests → Requests (Protected)
/clinics/select → SelectClinic
```



### 10. احراز هویت

**فایل:** `hospital-client/src/contexts/AuthContext.tsx`**ویژگی‌ها:**

- مدیریت state کاربر
- ذخیره token در localStorage
- Protected routes
- Auto-logout در صورت انقضای token

## UI/UX Design

### 11. طراحی و استایل

**راهکار:**

- استفاده از Tailwind CSS برای styling سریع
- طراحی Responsive (Mobile-first)
- رنگ‌بندی:
- رنگ اصلی: آبی/سبز پزشکی
- رنگ ثانویه: سفید/خاکستری
- فونت: فونت فارسی خوانا (Vazir یا IRANSans)

**کامپوننت‌های UI:**

- دکمه‌های زیبا با hover effects
- کارت‌های خدمت با shadow و border-radius
- فرم‌های تمیز و کاربرپسند
- Loading states
- Error states
- Toast notifications

### 12. تجربه کاربری

**بهبودها:**

- راهنمای مرحله‌به‌مرحله در فرم ثبت درخواست
- نمایش پیشرفت (Progress bar)
- Validation در زمان تایپ
- پیام‌های خطای واضح
- Confirmation dialogs برای اقدامات مهم

## مراحل پیاده‌سازی

### Phase 1: Setup و Infrastructure

1. نصب dependencies
2. تنظیم routing
3. تنظیم API client
4. ایجاد AuthContext
5. ایجاد layout components (Header, Footer)

### Phase 2: صفحات اصلی

1. صفحه Home
2. صفحه ServicesList
3. صفحه ServiceDetail
4. صفحه Register/Login

### Phase 3: فرم ثبت درخواست

1. BookService (مراحل 1-6)
2. SelectClinic با فیلتر بیمه
3. PatientForm
4. InsuranceSelector

### Phase 4: خدمات آزمایشگاه

1. BookLab (با/بدون کد رهگیری)
2. TrackResult
3. اضافه کردن TrackingCode به Backend

### Phase 5: پروفایل بیمار

1. Profile page
2. Requests list
3. Request details

### Phase 6: Polish و Testing

1. بهبود UI/UX
2. تست تمام flowها
3. Responsive testing
4. Performance optimization

## فایل‌های کلیدی برای تغییر

### Backend:

- `backend/HospitalSystem.Domain/Entities/ServiceRequest.cs` - اضافه TrackingCode
- `backend/HospitalSystem.Api/Controllers/ServiceRequestsController.cs` - endpoint رهگیری
- `backend/HospitalSystem.Api/Controllers/ClinicsController.cs` - فیلتر بر اساس بیمه

### Frontend (hospital-client):

- تمام فایل‌های `src/` نیاز به ایجاد دارند
- `package.json` - اضافه dependencies
- `vite.config.ts` - تنظیمات build
- `tailwind.config.js` - تنظیمات Tailwind (در صورت استفاده)

## نکات مهم